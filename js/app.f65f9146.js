(function(e){function t(t){for(var r,a,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&p.push(n[a][0]),n[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(p.length)p.shift()();return i.push.apply(i,u||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],r=!0,s=1;s<o.length;s++){var c=o[s];0!==n[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=o[0]))}return e}var r={},n={app:0},i=[];function a(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=r,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(o,r,function(t){return e[t]}.bind(null,r));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/MyWay/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"19b9":function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var r=o("2b0e"),n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},i=[],a=o("5f5b"),s=o("b1e0");r["default"].use(a["a"]),r["default"].use(s["a"]);var c={name:"MyWay"},u=c,l=(o("5c0b"),o("2877")),d=Object(l["a"])(u,n,i,!1,null,null,null),p=d.exports,m=(o("a623"),o("a434"),o("b0c0"),o("d3b7"),o("ddb0"),o("96cf"),o("1da1")),h=o("2f62"),f=o("74ce"),b=o("9e91"),g=o("aeb1"),v=o.n(g);r["default"].use(h["a"]);var w="MyWayDB2",j=function(){var e=new f["a"](w);return e.version(1).stores({projects:"name"}),e},y=new h["a"].Store({state:{projectNames:[],project:{userMode:!1,groups:[],name:""}},mutations:{empty:function(e,t){e.project=t.project,e.projectNames=t.projectNames},update:function(e,t){e.project=t.project,e.projectNames=t.projectNames}},actions:{load:function(e,t,o){return Object(m["a"])(regeneratorRuntime.mark((function r(){var n,i,a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,j();case 2:return n=r.sent,r.next=5,n.projects.toCollection().keys();case 5:return i=r.sent,i||(i=[]),r.next=9,n.projects.get(t);case 9:if(a=r.sent,!a){for(a={name:t,groups:[],freshGroup:null,switchCount:2,talkoverMode:"yes",userMode:!1},s=0;s<7;s++)a.groups.push({id:""+s,clips:[],nextClipId:0,keyCode:null,keyName:null,highlighted:!1,sequence:[],oldSequenceIndex:0,sequenceIndex:0,mode:"Sequence",active:!0,icon:"circle-fill",color:"#007bff"});a.freshGroup=a.groups.splice(7)[0]}e.commit(o?"empty":"update",{project:a,projectNames:i});case 12:case"end":return r.stop()}}),r)})))()},saveProject:function(e,t){var o=this;return Object(m["a"])(regeneratorRuntime.mark((function r(){var n,i,a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(""!=t.name){r.next=9;break}n=function(o){var r="Unnamed project"+(o>1?" "+o:"");if(e.getters.projectNames.every((function(e){return e!=r})))return t.name=r,"break"},i=1;case 3:if(a=n(i),"break"!==a){r.next=6;break}return r.abrupt("break",9);case 6:i++,r.next=3;break;case 9:return r.next=11,j();case 11:return s=r.sent,r.next=14,s.projects.put(t);case 14:o.dispatch("load",t.name,!1);case 15:case"end":return r.stop()}}),r)})))()},deleteProject:function(e,t){var o=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:return r=e.sent,e.next=5,r.projects.delete(t);case 5:o.dispatch("load","",!1);case 6:case"end":return e.stop()}}),e)})))()},downloadProjects:function(){return Object(m["a"])(regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:return t=e.sent,e.next=5,Object(b["a"])(t,{noTransaction:!0});case 5:o=e.sent,v()(o,"myway-export.json","application/json");case 7:case"end":return e.stop()}}),e)})))()},importProjects:function(e,t){var o=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:return r=e.sent,e.next=5,Object(b["b"])(r,t);case 5:o.dispatch("load","",!1);case 6:case"end":return e.stop()}}),e)})))()}},getters:{project:function(e){return e.project},projectNames:function(e){return e.projectNames}}}),k=o("8c4f"),x=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-container",{attrs:{fluid:""}},[o("LongPressCollapse",{ref:"fileManagerToolbarCollapse",attrs:{enabled:e.project.userMode}},[o("b-img",{attrs:{src:"logo-small.png",alt:"My way: communicate, create, explore",left:""}}),o("b-navbar",{staticClass:"mt-2"},[o("b-navbar-nav",{staticClass:"ml-auto"},[o("FileManagerToolbar",{ref:"fileManagerToolbar",staticClass:"mr-3",attrs:{project:e.project}}),o("div",{staticClass:"m-1"},[o("b-form-checkbox",{attrs:{switch:""},on:{change:e.toggleUserMode},model:{value:e.project.userMode,callback:function(t){e.$set(e.project,"userMode",t)},expression:"project.userMode"}},[e._v(" User mode ")])],1)],1)],1)],1),e.project.userMode?o("UserMode",{ref:"userMode",attrs:{project:e.project},on:{pressed:e.pressed}}):[o("ProjectSetupBar",{ref:"projectSetupBar",attrs:{project:e.project},on:{rename:e.renameProject,change:e.updated}}),o("b-card-group",{attrs:{deck:""}},e._l(e.project.groups.slice(0,e.project.switchCount),(function(t){return o("GroupCard",{key:t.id,attrs:{group:t,"border-variant":t.highlighted?"dark":""},on:{change:e.updated,pressed:e.pressed,remove:e.remove}})})),1)],o("Presenter",{ref:"presenter",attrs:{project:e.project},on:{pressed:e.pressed}})],2)},_=[],$=(o("ac1f"),o("5319"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.manual",modifiers:{manual:!0}}],staticClass:"float-right",attrs:{disabled:!e.enabled,variant:"link",title:"Press and hold to expand",id:e._uid+"-tooltip"},on:{mousedown:e.start,mouseleave:e.stop,mouseup:e.stop,touchstart:e.start,touchend:e.stop,touchcancel:e.stop}},[o("b-icon",{attrs:{icon:e.showing?"chevron-compact-up":"chevron-compact-down"}})],1),o("b-collapse",{model:{value:e.showing,callback:function(t){e.showing=t},expression:"showing"}},[e._t("default")],2)],1)}),C=[],S={props:{enabled:{required:!0,type:Boolean}},data:function(){return{showing:!0,timeout:null,tooltipTimeout:null}},methods:{hide:function(){this.showing=!1},start:function(){var e=this;this.showing?this.showing=!1:this.timeout=window.setTimeout((function(){e.timeout=null,e.showing=!0}),800)},stop:function(){var e=this;null!=this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null,this.$root.$emit("bv::show::tooltip",this._uid+"-tooltip"),this.tooltipTimeout&&window.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=window.setTimeout((function(){e.$root.$emit("bv::hide::tooltip",e._uid+"-tooltip"),e.tooltipTimeout=null}),1e3))}}},M=S,P=Object(l["a"])(M,$,C,!1,null,null,null),O=P.exports,R=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-button-toolbar",[o("b-button-group",{staticClass:"ml-2",attrs:{size:"sm"}},[o("b-button",{on:{click:function(t){return e.loadProject("",!1)}}},[o("b-icon",{attrs:{icon:"file-plus"}}),e._v(" New ")],1),o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.load-modal",modifiers:{"load-modal":!0}}]},[o("b-icon",{attrs:{icon:"files"}}),e._v(" Open ")],1),o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.delete-modal",modifiers:{"delete-modal":!0}}]},[o("b-icon",{attrs:{icon:"trash"}}),e._v(" Delete ")],1)],1),o("b-button-group",{staticClass:"ml-2",attrs:{size:"sm"}},[o("b-button",{on:{click:e.downloadProjects}},[o("b-icon",{attrs:{icon:"box-arrow-down"}}),e._v(" Download all ")],1),o("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],ref:"importButton",attrs:{title:"Drag and drop exported database file here to import."}},[o("b-icon",{attrs:{icon:"box-arrow-in-up"}}),e._v(" Import ")],1)],1),o("b-button-group",{staticClass:"ml-2",attrs:{size:"sm"}},[o("b-button",{on:{click:e.openDonateWindow}},[o("b-icon",{attrs:{icon:"heart"}}),e._v(" Donate ")],1)],1)],1),o("b-modal",{attrs:{id:"load-modal",title:"Select project to open","hide-footer":""}},[o("b-list-group",e._l(e.projectNames,(function(t){return o("b-list-group-item",{key:t,attrs:{button:""},on:{click:function(o){return e.loadProject(t,!1)}}},[e._v(" "+e._s(t)+" ")])})),1)],1),o("b-modal",{attrs:{id:"delete-modal","ok-title":"Yes",cancelTitle:"No","ok-variant":"danger","hide-header-close":"","hide-header":""},on:{ok:function(t){return e.deleteProject(e.project.name)}}},[e._v(" Delete "+e._s(e.project.name)+"? ")])],1)},T=[],q=o("5530"),N=o("2ef0"),B=o.n(N),I={props:{project:{required:!0,type:Object,name:""}},mounted:function(){var e=this;this.$refs.importButton.ondragover=function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},this.$refs.importButton.ondrop=function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(o){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o.stopPropagation(),o.preventDefault(),r=o.dataTransfer.files[0],t.prev=3,r){t.next=6;break}throw new Error("Only files can be dropped here");case 6:return console.log("Importing "+r.name),t.next=9,e.importProjects(r);case 9:console.log("Import complete"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](3),console.error(""+t.t0);case 15:e.$bvModal.show("load-modal");case 16:case"end":return t.stop()}}),t,null,[[3,12]])})));return function(e){return t.apply(this,arguments)}}()},methods:Object(q["a"])(Object(q["a"])({},Object(h["b"])(["load","saveProject","deleteProject","downloadProjects","importProjects"])),{},{loadProject:function(e,t){var o=this;return Object(m["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:o.$bvModal.hide("load-modal"),o.load(e,t);case 2:case"end":return r.stop()}}),r)})))()},spliceGroup:function(e){this.project.groups.splice(e,1),this.project.groups.push(B.a.cloneDeep(this.project.freshGroup));for(var t=0;t<6;t++)this.project.groups[t].id=""+t},renameProject:function(e,t){this.saveProject(e),this.deleteProject(e.name),e.name=t,this.saveProject(e),this.loadProject(e.name,!1)},openDonateWindow:function(){window.open("https://thepacecentre.charitycheckout.co.uk/donate","_blank")}}),computed:Object(q["a"])({},Object(h["c"])(["projectNames"]))},W=I,z=Object(l["a"])(W,R,T,!1,null,null,null),E=z.exports,U=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-container",[o("b-row",{staticClass:"text-center py-5"},e._l(e.project.groups.slice(0,Math.min(3,e.project.switchCount)),(function(t){return o("b-col",{key:t.name},[o("b-icon",{ref:"button-"+t.id,refInFor:!0,staticClass:"big-button",style:"color: "+t.color,attrs:{icon:t.icon,"font-scale":"20%"},on:{mousedown:function(o){return e.$emit("pressed",t.id)},touchstart:function(o){return e.$emit("pressed",t.id)}}})],1)})),1),e.project.switchCount>3?o("b-row",{staticClass:"text-center"},e._l(e.project.groups.slice(3,Math.min(6,e.project.switchCount)),(function(t){return o("b-col",{key:t.name},[o("b-icon",{ref:"button-"+t.id,refInFor:!0,staticClass:"big-button",style:"color: "+t.color,attrs:{icon:t.icon,"font-scale":"20%"},on:{mousedown:function(o){return e.$emit("pressed",t.id)},touchstart:function(o){return e.$emit("pressed",t.id)}}})],1)})),1):e._e()],1)},D=[],A={props:{project:{required:!0,type:Object}},methods:{handlePress:function(e){var t=this.$refs["button-"+e][0];t.classList.remove("animate"),window.setTimeout((function(){t.classList.add("animate")}),1)}}},L=A,G=(o("8224"),Object(l["a"])(L,U,D,!1,null,null,null)),F=G.exports,K=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-form",{staticClass:"mb-4 mt-2",attrs:{inline:""},on:{submit:function(e){e.stopPropagation(),e.preventDefault()}}},[o("b-form-input",{staticClass:"ml-auto mr-3",attrs:{size:"sm",placeholder:"Project name",trim:""},on:{blur:function(t){return e.$emit("rename",e.project,e.projectNameSetByUser)}},model:{value:e.projectNameSetByUser,callback:function(t){e.projectNameSetByUser=t},expression:"projectNameSetByUser"}}),o("label",{staticClass:"mr-2",attrs:{for:"switches"}},[e._v("Switches:")]),o("b-form-spinbutton",{staticClass:"mr-3",attrs:{size:"sm",id:"switches",min:"1",max:"6"},on:{change:function(t){return e.$emit("change")}},model:{value:e.project.switchCount,callback:function(t){e.$set(e.project,"switchCount",t)},expression:"project.switchCount"}}),o("label",{staticClass:"mr-2",attrs:{for:"talkover"}},[e._v("Talk over:")]),o("b-form-radio-group",{staticClass:"mr-3",attrs:{size:"sm",label:"Talk-over mode",options:e.talkoverModes,"button-variant":"outline-secondary",buttons:""},on:{change:function(t){return e.$emit("change")}},model:{value:e.project.talkoverMode,callback:function(t){e.$set(e.project,"talkoverMode",t)},expression:"project.talkoverMode"}})],1)},H=[],J={props:{project:{required:!0,type:Object}},data:function(){return{projectNameSetByUser:"",talkoverMode:"no",talkoverModes:[{text:"Yes",value:"yes"},{text:"Interrupt",value:"interrupt"},{text:"No",value:"no"}]}},methods:{updateProject:function(e){this.projectNameSetByUser=e}}},Y=J,Q=Object(l["a"])(Y,K,H,!1,null,null,null),V=Q.exports,X=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-card",{attrs:{"no-body":""},scopedSlots:e._u([{key:"header",fn:function(){return[o("b-button-toolbar",[o("b-button",{staticClass:"m-1",attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(t){return e.$emit("pressed",e.group.id)}}},[o("b-icon",{style:"color: "+e.group.color,attrs:{icon:e.group.icon}})],1),o("b-button-group",{staticClass:"m-1",attrs:{size:"sm"}},[o("b-dropdown",{staticClass:"icon-dropdown",attrs:{size:"sm"},scopedSlots:e._u([{key:"button-content",fn:function(){return[o("b-icon",{attrs:{icon:e.group.icon.substring(0,e.group.icon.length-"-fill".length)}})]},proxy:!0}])},e._l(e.icons,(function(t){return o("b-dropdown-item",{key:t,attrs:{href:"#"},on:{click:function(o){return e.setIcon(t)}}},[o("b-icon",{style:"color: "+e.group.color,attrs:{icon:t}})],1)})),1),o("b-dropdown",{staticClass:"icon-dropdown",attrs:{size:"sm"},scopedSlots:e._u([{key:"button-content",fn:function(){return[o("b-icon",{attrs:{icon:"droplet"}})]},proxy:!0}])},e._l(e.colors,(function(t){return o("b-dropdown-item",{key:t,attrs:{href:"#"},on:{click:function(o){return e.setColor(t)}}},[o("b-icon",{style:"color: "+t,attrs:{icon:e.group.icon}})],1)})),1),o("KeyBindingButton",{attrs:{group:e.group},on:{press:function(t){return e.$emit("pressed",e.group.id)},change:function(t){return e.$emit("change")}}})],1),o("b-dropdown",{staticClass:"m-1",attrs:{size:"sm",text:e.group.mode}},[o("b-dropdown-item",{attrs:{href:"#"},on:{click:e.setMode}},[e._v("Sequence")]),o("b-dropdown-item",{attrs:{href:"#"},on:{click:e.setMode}},[e._v("Shuffle")]),o("b-dropdown-item",{attrs:{href:"#"},on:{click:e.setMode}},[e._v("Random")]),o("b-dropdown-divider"),o("b-dropdown-item",{attrs:{href:"#"},on:{click:e.setMode}},[e._v("Scan")]),o("b-dropdown-item",{attrs:{href:"#"},on:{click:e.setMode}},[e._v("Prompt")]),o("b-dropdown-divider"),o("b-dropdown-item",{attrs:{href:"#"},on:{click:e.setMode}},[e._v("Converse A")]),o("b-dropdown-item",{attrs:{href:"#"},on:{click:e.setMode}},[e._v("Converse B")])],1),o("b-button",{staticClass:"m-1",attrs:{size:"sm"},on:{click:function(t){return e.$emit("remove",e.group.id)}}},[o("b-icon",{attrs:{icon:"trash"}})],1)],1)]},proxy:!0}])},[o("b-overlay",{attrs:{show:"Prompt"==e.group.mode,rounded:"sm"},scopedSlots:e._u([{key:"overlay",fn:function(){return[e._v(" 'Prompt' mode plays clips from another switch at full volume. ")]},proxy:!0}])},[o("draggable",e._b({staticClass:"list-group",attrs:{tag:"b-list-group","component-data":e.listGroupOptions(),list:e.group.clips,handle:".handle"},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1},change:function(t){return e.$emit("change")}}},"draggable",e.dragOptions,!1),[e._l(e.group.clips,(function(t,r){return o("b-list-group-item",{key:t.id,attrs:{variant:t.highlighted?"warning":""}},[o("Clip",{attrs:{clip:t,index:r},on:{remove:function(t){e.group.clips.splice(r,1),e.$emit("change")},change:function(t){return e.$emit("change")}}})],1)})),o("b-list-group-item",{attrs:{slot:"footer"},slot:"footer"},[o("b-button",{attrs:{variant:"success"},on:{click:e.addClip}},[e._v(" Add clip ")])],1)],2)],1)],1)},Z=[],ee=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-input-group",{attrs:{size:"sm"}},[o("b-input-group-prepend",[o("b-input-group-text",{staticClass:"handle"},[o("b-icon-grid3x3-gap",{attrs:{variant:"light"}})],1)],1),o("b-form-input",{attrs:{placeholder:e.placeholder},on:{change:function(t){return e.$emit("change")}},model:{value:e.clip.name,callback:function(t){e.$set(e.clip,"name",t)},expression:"clip.name"}}),o("b-input-group-append",[o("record-audio-button",{attrs:{clip:e.clip},on:{change:e.updateRecording}}),o("b-button",{on:{click:function(t){return e.$emit("remove")}}},[o("b-icon-x")],1)],1)],1)},te=[],oe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.manual",modifiers:{manual:!0}}],ref:"button",staticClass:"recorder",attrs:{title:"Hold to record",id:e._uid+"-tooltip"},on:{mousedown:e.start,mouseleave:e.stop,mouseup:e.stop,touchstart:e.start,touchend:e.stop,touchcancel:e.stop}},[e.clip.blob||e.isRecording?e._e():o("b-icon-mic"),e.isRecording?o("b-icon-mic-fill"):e._e(),e.clip.blob?o("b-icon-play-fill"):e._e()],1)},re=[],ne=(o("4160"),o("3ca3"),o("159b"),o("2b3d"),{name:"RecordAudioButton",props:{clip:{required:!0,type:Object}},data:function(){return{icon:"mic",isSupported:!1,hasPermission:!1,isRecording:!1,isPaused:!1,chunks:[],tooltipTimeout:null}},mounted:function(){(navigator.mediaDevices||navigator.mediaDevices.getUserMedia)&&(this.isSupported=!0)},methods:{start:function(){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.clip.blob){t.next=3;break}return e.play(),t.abrupt("return");case 3:if(!e.isRecording){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,t.next=8,e.getStream();case 8:e.$_stream=t.sent,e.prepareRecorder(),e.$_mediaRecorder.start(),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](5),e.$emit("error",t.t0);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})))()},stop:function(){this.isRecording&&(this.$_mediaRecorder.stop(),this.$_stream.getTracks().forEach((function(e){return e.stop()})))},getStream:function(){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:return o=t.sent,e.$_stream=o,e.$emit("stream",o),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})))()},prepareRecorder:function(){var e=this;this.$_stream&&(this.$_mediaRecorder=new MediaRecorder(this.$_stream,{mimeType:"audio/webm"}),this.$_mediaRecorder.ignoreMutedMedia=!0,this.$_mediaRecorder.addEventListener("start",(function(){e.isRecording=!0,e.isPaused=!1,e.startTime=new Date,e.$emit("start")})),this.$_mediaRecorder.addEventListener("dataavailable",(function(t){t.data&&t.data.size>0&&e.chunks.push(t.data)}),!0),this.$_mediaRecorder.addEventListener("stop",(function(){var t=new Date-e.startTime;t>500&&e.chunks.length>0?(e.clip.blob=new Blob(e.chunks),e.chunks=[],e.$emit("change",e.clip.blob)):(e.$root.$emit("bv::show::tooltip",e._uid+"-tooltip"),e.tooltipTimeout&&window.clearTimeout(e.tooltipTimeout),e.tooltipTimeout=window.setTimeout((function(){e.$root.$emit("bv::hide::tooltip",e._uid+"-tooltip"),e.tooltipTimeout=null}),1e3)),e.isPaused=!1,e.isRecording=!1}),!0))},play:function(){this.clip.blob&&new Audio(window.URL.createObjectURL(this.clip.blob)).play()}}}),ie=ne,ae=Object(l["a"])(ie,oe,re,!1,null,null,null),se=ae.exports,ce={components:{RecordAudioButton:se},props:{clip:{required:!0,type:Object}},computed:{placeholder:function(){return"Clip "+(this.clip.index+1)}},methods:{updateRecording:function(){this.$emit("change")}}},ue=ce,le=(o("ef1a"),Object(l["a"])(ue,ee,te,!1,null,null,null)),de=le.exports,pe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.bottom",value:"Hold while pressing the key to use for the switch",expression:"\n    'Hold while pressing the key to use for the switch'\n  ",modifiers:{hover:!0,bottom:!0}}],attrs:{variant:e.group.active?"secondary":"outline-secondary",size:"sm"},on:{mousedown:function(t){e.held=!0},mouseleave:function(t){e.held=!1},mouseup:function(t){e.held=!1},touchstart:function(t){e.held=!0},touchend:function(t){e.held=!1},touchcancel:function(t){e.held=!1}}},[e.group.keyName?e._e():[e._v("Switch")],e.group.keyName?o("kbd",{staticClass:"ml-1"},[e._v(e._s(e.group.keyName))]):e._e()],2)},me=[],he={name:"KeyBindingButton",data:function(){return{held:!1}},props:{group:{required:!0,type:Object}},mounted:function(){window.addEventListener("keydown",function(e){if(!e.isComposing){var t=e.keyCode;if(this.held){this.group.keyCode=t,this.group.keyName="not set";var o={8:"backspace / delete",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause/break",20:"caps lock",27:"escape",32:"spacebar",33:"page up",34:"page down",35:"end",36:"home",37:"left arrow",38:"up arrow",39:"right arrow",40:"down arrow",91:"Windows Key / Left ⌘ / Chromebook Search key",92:"right window key",93:"Windows Menu / Right ⌘"};this.group.keyName=t in o?o[t]:String.fromCharCode(t),this.$emit("change")}}}.bind(this))}},fe=he,be=Object(l["a"])(fe,pe,me,!1,null,null,null),ge=be.exports,ve=o("310e"),we=o.n(ve);r["default"].component("draggable",we.a);var je={components:{Clip:de,KeyBindingButton:ge,draggable:we.a},data:function(){return{drag:!1}},props:{group:{required:!0,type:Object}},computed:{dragOptions:function(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}},icons:function(){return["circle-fill","square-fill","triangle-fill","pentagon-fill","star-fill","heart-fill","lightning-fill","puzzle-fill"]},colors:function(){return{blue:"#007bff",indigo:"#6610f2",purple:"#6f42c1",pink:"#e83e8c",red:"#dc3545",orange:"#fd7e14",yellow:"#ffc107",green:"#28a745",teal:"#20c997",cyan:"#17a2b8"}}},methods:{addClip:function(){var e=this.group.nextClipId++;this.group.clips.push({id:this.group.id+"-"+e,index:e,name:"",blob:null,highlighted:!1}),this.group.sequence=[];for(var t=0;t<this.group.clips.length;t++)this.group.sequence.push(t);this.$emit("change")},setMode:function(e){this.group.mode=e.target.text,this.$emit("change")},setColor:function(e){this.group.color=e,this.$emit("change")},setIcon:function(e){this.group.icon=e,this.$emit("change")},listGroupOptions:function(){return{attrs:{flush:!0}}}}},ye=je,ke=(o("71a3"),Object(l["a"])(ye,X,Z,!1,null,null,null)),xe=ke.exports,_e=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-alert",{staticClass:"position-fixed fixed-bottom m-0 rounded-0",staticStyle:{"z-index":"2000"},attrs:{show:e.converseWarningShowSeconds,variant:"warning",dismissible:""},on:{dismissed:function(t){e.converseWarningShowSeconds=0}}},[e._v(" Press other switch for converse ")]),o("b-alert",{staticClass:"position-fixed fixed-bottom m-0 rounded-0",staticStyle:{"z-index":"2000"},attrs:{show:e.promptScanWarningShowSeconds,variant:"warning",dismissible:""},on:{dismissed:function(t){e.promptScanWarningShowSeconds=0}}},[e._v(" To use Prompt/Scan mode, set one switch to 'Scan' with a list of clips to scan through at low volume, and another to 'Prompt' to trigger playback of the selected clip at full volume ")]),o("b-alert",{staticClass:"position-fixed fixed-bottom m-0 rounded-0",staticStyle:{"z-index":"2000"},attrs:{show:e.talkoverWarningShowSeconds,variant:"warning",dismissible:""},on:{dismissed:function(t){e.talkoverWarningShowSeconds=0}}},[e._v(" Already playing a clip. Change talkover mode to allow interruption/talk-over. ")])],1)},$e=[],Ce=(o("7db0"),o("b85c")),Se={props:{project:{required:!0,type:Object}},data:function(){return{promptScanWarningShowSeconds:0,converseWarningShowSeconds:0,talkoverWarningShowSeconds:0,lastAudio:null}},watch:{"project.mode":function(){this.update()}},mounted:function(){window.addEventListener("keydown",function(e){if(!e.isComposing){var t,o=Object(Ce["a"])(this.project.groups);try{for(o.s();!(t=o.n()).done;){var r=t.value;r.keyCode==e.keyCode&&this.$emit("pressed",r.id)}}catch(n){o.e(n)}finally{o.f()}}}.bind(this))},methods:{handlePress:function(e){var t=this.project.groups[e];if(null!=this.lastAudio&&!this.lastAudio.ended)if("interrupt"==this.project.talkoverMode||"Prompt"==t.mode||"Scan"==t.mode)this.lastAudio.pause(),this.lastAudio=null;else if("no"==this.project.talkoverMode)return void(this.talkoverWarningShowSeconds=2);if("Prompt"!=t.mode)t.active?(this.playClip(t),this.advance(t)):this.converseWarningShowSeconds=2;else{var o=B.a.find(this.project.groups,(function(e){return"Scan"==e.mode}));o?(o.sequenceIndex=o.oldSequenceIndex,this.playClip(o,!0),this.advance(t)):this.promptScanWarningShowSeconds=8}},playClip:function(e,t){var o=e.sequence[e.sequenceIndex];if(0!=e.clips.length){var r=e.clips[o];if(r.blob){var n=new Audio(window.URL.createObjectURL(r.blob));this.lastAudio=n,"Scan"!=e.mode||t||(n.volume=.2),n.play()}var i,a=Object(Ce["a"])(e.clips);try{for(a.s();!(i=a.n()).done;){var s=i.value;s.highlighted=!1}}catch(c){a.e(c)}finally{a.f()}r.highlighted=!0}},advance:function(e){if(e.oldSequenceIndex=e.sequenceIndex,"Random"==e.mode?e.sequenceIndex=B.a.random(Math.max(0,e.sequence.length-1)):++e.sequenceIndex==e.clips.length&&(e.sequenceIndex=0,"Shuffle"==e.mode&&(e.sequence=B.a.shuffle(e.sequence))),"Converse A"==e.mode){var t=B.a.find(this.project.groups,(function(e){return"Converse B"==e.mode}));t&&(e.sequenceIndex>0||t.sequenceIndex>0)&&(t.active=!0,e.active=!1)}else if("Converse B"==e.mode){var o=B.a.find(this.project.groups,(function(e){return"Converse A"==e.mode}));o&&(o.active=!0,e.active=!1)}},update:function(){var e,t=Object(Ce["a"])(this.project.groups);try{for(t.s();!(e=t.n()).done;){var o=e.value;switch(o.sequence=B.a.range(0,o.clips.length),o.sequenceIndex=0,o.oldSequenceIndex=0,o.active=!0,o.mode){case"Shuffle":o.sequence=B.a.shuffle(o.sequence);break;case"Random":o.sequenceIndex=B.a.random(Math.max(0,o.sequence.length-1));break;case"Converse B":o.active=!1;break}}}catch(r){t.e(r)}finally{t.f()}}}},Me=Se,Pe=Object(l["a"])(Me,_e,$e,!1,null,null,null),Oe=Pe.exports;r["default"].use(a["a"]);var Re={components:{LongPressCollapse:O,FileManagerToolbar:E,UserMode:F,ProjectSetupBar:V,GroupCard:xe,Presenter:Oe},props:["projectName"],computed:Object(h["c"])(["project"]),watch:{"project.name":function(e){var t=this.$route.params.projectName||"";console.log("Watch project name "+t+" -> "+e),e&&e.length>0?document.title=e+" - My Way":document.title="My way",e!=t&&this.$router.replace({path:"/project/".concat(e)}),this.$refs.projectSetupBar.updateProject(e)}},mounted:function(){console.log("Mounted: "+this.$route.params.projectName),this.$refs.fileManagerToolbar.loadProject(this.$route.params.projectName||"",!0)},methods:{updated:function(){this.$refs.fileManagerToolbar.saveProject(this.project),this.$refs.presenter.update()},remove:function(e){this.$refs.fileManagerToolbar.spliceGroup(e),this.updated()},pressed:function(e){this.$refs.presenter.handlePress(e),this.$refs.userMode&&this.$refs.userMode.handlePress(e)},renameProject:function(e,t){this.$refs.fileManagerToolbar.renameProject(e,t)},toggleUserMode:function(){this.project.userMode||this.$refs.fileManagerToolbarCollapse.hide(),this.updated()}}},Te=Re,qe=Object(l["a"])(Te,x,_,!1,null,null,null),Ne=qe.exports;r["default"].use(k["a"]);var Be=[{path:"/project/:projectName",component:Ne,props:!0},{path:"/(project)?",component:Ne}],Ie=new k["a"]({routes:Be}),We=Ie,ze=o("a584");r["default"].config.productionTip=!1,r["default"].use(ze["a"],{config:{id:"UA-166921881-1"}}),new r["default"]({store:y,router:We,render:function(e){return e(p)}}).$mount("#app")},"5c0b":function(e,t,o){"use strict";var r=o("9c0c"),n=o.n(r);n.a},"71a3":function(e,t,o){"use strict";var r=o("cd19"),n=o.n(r);n.a},8224:function(e,t,o){"use strict";var r=o("19b9"),n=o.n(r);n.a},8460:function(e,t,o){},"9c0c":function(e,t,o){},cd19:function(e,t,o){},ef1a:function(e,t,o){"use strict";var r=o("8460"),n=o.n(r);n.a}});
//# sourceMappingURL=app.f65f9146.js.map